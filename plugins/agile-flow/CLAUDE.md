# Agile Flow 插件

> AI驱动的敏捷开发插件：轻量级任务管理，与现有插件协同工作

---

### 插件协同
```
prompt-enhancer → agile-flow → feature-dev → agile-flow → code-simplifier
   需求优化        任务管理      功能开发      测试验收      架构优化
```

| 插件 | 职责 |
|------|------|
| **prompt-enhancer** | 需求优化，使用 BROKE/RTF 等框架优化需求描述 |
| **agile-flow** | 任务管理和流转，测试验收，文档更新 |
| **feature-dev** | 功能开发，技术设计，代码实现 |
| **code-simplifier** | 架构优化，代码重构 |

---

## 典型工作流程


### 任务流程(顺序执行)
  需求 -> 任务 -> 测试 -> BUG修复 -> 测试 -> 验收

##### 需求阶段
```
1. 需求全部记录在PRD.md
2. 接收到需求后,使用/prompt-enhancer插件对需求进行prompt优化
3. 使用优化后的prompt生成计划，追加到PLAN.md
```

##### 任务阶段
```
1. 任务全部记录在PLAN.md
2. 接收到任务后,使用/feature-dev插件完成任务
3. 如果任务是编程,使用/code-review和/code-simplifier对代码进行审核,优化和修改,必须完全符合要求才能通过
4. 提交git commit
5. 任务完成后，PLAN.md中该任务状态改为 `待测试`
```

##### 测试阶段
```
1. 对PLAN.md中`待测试`任务进行测试验证
2. 生成单元测试用例,要求测试覆盖率80%
3. 单元测试结束后，必须启动项目进行真实环境测试,验证以下测试事项
  a. 查看日志是否有error信息
  b. 使用playwright进行功能验证
4. 发现BUG,不要自己改代码，将相关信息详细记录到BUGS.md中, PLAN.md中该任务状态改为 `BUG`, 跳转到BUG修复阶段
5. 测试完成后, 无BUG, PLAN.md中该任务状态改为 `已测试`, 跳转到验收阶段
```

##### BUG修复
```
1. 使用/feature-dev插件修复PLAN.md中状态为`BUG`的任务
2. 如果任务是编程,使用/code-review和/code-simplifier对代码进行审核,优化和修改,必须完全符合要求才能通过
3. 提交git commit
4. 任务完成后，PLAN.md中该任务状态改为 `待测试`, 跳转到测试阶段
```


##### 验收
```
1. 总结核心内容(200字内)到ACCEPTANCE.md
2. 将与项目相关的核心内容(50字内)总结到CONTEXT.md
3. 如果有API变更, 记录API.md文档
```

## 文档系统

### 固定在ai-docs目录下
| 文档 | 类型 | 用途 |
|------|--|------|
| PRD.md | 必需 | 项目需求文档 |
| PLAN.md | 必需 | 工作计划和任务清单 |
| ACCEPTANCE.md | 必需 | 任务验收报告 |
| BUGS.md | 必需 | Bug 列表 |
| OPS.md | 必需 | 操作指南 |
| CONTEXT.md | 必需 | 项目上下文 |
| API.md | 必需 | API 清单 |

如果项目已有文档（如 `PROJECT_STATUS.md`、`AI_CONTEXT.md`），agile-flow 可以使用它们。

---

## 任务管理

### 添加任务

随时可以添加任务，指定优先级：

```
p0: 实现用户认证功能
p1: 添加数据导出功能
实现文件上传功能  # 默认 P2
```

### 优先级

- **P0**: 关键任务，阻塞其他功能
- **P1**: 高优先级，重要但不阻塞
- **P2**: 中等优先级，可以延后
- **P3**: 低优先级，有时间再做

### 自动流转

任务完成后，agile-flow 自动：
1. 运行测试（覆盖率 ≥ 80%）
2. 检查验收标准
3. 更新验收报告
4. 继续下一个优先级最高的任务

---

#### Stop Hook

当接收到stop hook指令时

**流程**:
- 显示项目状态和任务统计
- 提供下一步操作建议
- 使用 /agile-continue 继续下一个任务

**输出示例**:
```
────────────────────────────────────
🔍 agile-flow 项目: /data/project/my-app
📊 迭代 1: 已完成 5 个，待办 3 个
────────────────────────────────────
```

# 必须执行
永远不要使用AskUserQuestion工具询问用户